<loader *ngIf="loading"></loader>
<div class="container" *ngIf="!loading">

    <h2 *ngIf="!model.childId">{{ '_RegisterChildBtn_' | translate }}</h2>
    <h2 *ngIf="model.childId">{{ '_EditChild_' | translate }}</h2>

    <div style="height: 50px;">
        <p class="text-danger"> {{ '_Mandatory_' | translate }} </p>
    </div>

    <form (ngSubmit)="createChild()" #childForm="ngForm" class="col-md-8">
        <div class="row">
            <div class="form-group">
                <label for="username">{{ '_ChildUsername_' | translate }} <span class="text-danger"> * </span></label>
                <input type="text" (ngModelChange)="validateUsername()" class="form-control" id="username" required pattern="^[A-Za-z0-9_-]{3,15}$" maxlength="30" [(ngModel)]="model.username" name="username" #username="ngModel">
                <div *ngIf="usernameError" class="alert alert-danger"> {{ '_RequiredUsername_' | translate }} </div>
            </div>
        </div>
        <div class="row">
            <div *ngIf="!model.childId" class="form-group" style="padding-left:0">
                <label for="password">{{ '_Password_' | translate }} <span class="text-danger"> * </span></label>
                <input type="password" (ngModelChange)="validatePassword()" class="form-control" id="password" required minlength="6" maxlength="255" validateEqual="confirmpassword" reverse="true" [(ngModel)]="model.password" name="password" #password="ngModel">
                <div *ngIf="passwordError || passwordLengthError" class="alert alert-danger"> {{ '_RequiredPassword_' | translate }} </div>
            </div>
        </div>
        <div class="row">
            <div *ngIf="!model.childId" class="form-group">
                <label for="confirmpassword">{{ '_ConfirmPassword_' | translate }} <span class="text-danger"> * </span></label>
                <input type="password" (ngModelChange)="validateConfirmPassword()" class="form-control" id="confirmpassword" required validateEqual="password" [(ngModel)]="model.confirmpassword" name="confirmpassword" #confirmpassword="ngModel">
                <div *ngIf="!confirmpassword.valid && !confirmpassword.pristine && !confirmpasswordError" class="alert alert-danger"> {{ '_RequiredConfirmPassword_' | translate }} </div>
                <div *ngIf="confirmpasswordError" class="alert alert-danger"> {{ '_RequiredConfirmPassword_' | translate }} </div>
            </div>
        </div>
        <div class="row">
            <div class="form-group">
                <label for="firstName">{{ '_FirstName_' | translate }} <span class="text-danger"> * </span></label>
                <input type="text" (ngModelChange)="validateFirstName()" class="form-control" id="firstName" required maxlength="30" [(ngModel)]="model.firstName" name="firstName" #firstName="ngModel">
                <div *ngIf="firstNameError" class="alert alert-danger"> {{ '_RequiredFirstName_' | translate }} </div>
            </div>
        </div>
        <div class="row">
            <div class="form-group">
                <label for="lastName">{{ '_LastName_' | translate }} <span class="text-danger"> * </span></label>
                <input type="text" (ngModelChange)="validateLastName()" class="form-control" id="lastName" required maxlength="50" [(ngModel)]="model.lastName" name="lastName" #lastName="ngModel">
                <div *ngIf="lastNameError" class="alert alert-danger"> {{ '_RequiredLastName_' | translate }} </div>
            </div>
        </div>
        <div class="row">
            <div class="form-group">
                <label for="birthDate">{{ '_BirthDate_' | translate }} <span class="text-danger"> * </span></label>
                <div>
                    <my-date-picker name="datepicker" [options]="myDatePickerOptions" [locale]="'pt-br'" [selDate]="selDate" (dateChanged)="onDateChanged($event)"></my-date-picker>
                    <input style="display:none;" name="birthDate" required #birthDate="ngModel" [(ngModel)]="model.birthDate">
                </div>
                <div *ngIf="!birthDate.valid && !birthDate.pristine" class="alert alert-danger"> {{ '_RequiredBirthdate_' | translate }} </div>
            </div>
        </div>
        <div class="row">
            <div class="form-group">
                <label for="gender">{{ '_Gender_' | translate }} <span class="text-danger"> * </span></label>
                <select class="form-control" id="gender" required [(ngModel)]="model.gender" name="gender" #gender="ngModel" (ngModelChange)="validateGender()">
                    <option *ngFor="let g of genders" [value]="g">{{ g | uppercase | translate }}</option>
                </select>
                <div *ngIf="genderError" class="alert alert-danger"> {{ '_RequiredGender_' | translate }} </div>
            </div>
        </div>
        <div class="row">
            <div style="height: 70px;">
                <div *ngIf="error" class="alert alert-danger"> {{ error | translate }} </div>
                <loader *ngIf="loadingAdd" [height]="50"></loader>
            </div>
        </div>

        <div class="row">
            <a *ngIf="!model.childId" type="button" (click)="submit()" class="btn btn-success">
                <span class="glyphicon glyphicon-ok" style="font-size: small;" aria-hidden="true"></span> {{ '_CreateChild_' | translate }}
            </a>
            <a *ngIf="model.childId" type="button" (click)="submitEdit()" class="btn btn-success">
                <span class="glyphicon glyphicon-ok" style="font-size: small;" aria-hidden="true"></span> {{ '_SaveChangesBtn_' | translate }}
            </a>
            <button [routerLink]="['/children']" type="button" class="btn btn-secondary"> 
                  <span class="glyphicon glyphicon-remove" style="font-size: small;" aria-hidden="true"></span> {{'_Cancel_' | translate }}
            </button>
        </div>
    </form>
</div>